<!DOCTYPE html><html class="hide-aside" lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"><title>前端项目搭建与后端部门管理实现（二） | 清风</title><meta name="author" content="清风"><meta name="copyright" content="清风"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="权限基础平台系统-部门管理内容 前端项目搭建 部门后端CRUD实现 跨域问题 前端-高级查询和分页 前端-删除 前端-部门添加和修改  一.前端项目搭建vue-admin是一个基于Vue+ElementUI快速开发的管理系统模板，直接使用开发工具导入模板即可开发自己的管理界面。  报错:  sass npm ERR! &amp;#110;&amp;#111;&amp;#100;&amp;#101;&amp;#45;&amp;#115;&amp;#97;"><meta property="og:type" content="article"><meta property="og:title" content="前端项目搭建与后端部门管理实现（二）"><meta property="og:url" content="https://mliutm.github.io/breeze/58abc14f.html"><meta property="og:site_name" content="清风"><meta property="og:description" content="权限基础平台系统-部门管理内容 前端项目搭建 部门后端CRUD实现 跨域问题 前端-高级查询和分页 前端-删除 前端-部门添加和修改  一.前端项目搭建vue-admin是一个基于Vue+ElementUI快速开发的管理系统模板，直接使用开发工具导入模板即可开发自己的管理界面。  报错:  sass npm ERR! &amp;#110;&amp;#111;&amp;#100;&amp;#101;&amp;#45;&amp;#115;&amp;#97;"><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://mliutm.github.io/img/photo-1645943020355-305df166473d.jpg"><meta property="article:published_time" content="2023-10-27T15:59:33.000Z"><meta property="article:modified_time" content="2023-10-27T16:05:58.771Z"><meta property="article:author" content="清风"><meta property="article:tag" content="java"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://mliutm.github.io/img/photo-1645943020355-305df166473d.jpg"><link rel="shortcut icon" href="/img/favicon.jpg"><link rel="canonical" href="https://mliutm.github.io/breeze/58abc14f.html"><link rel="preconnect" href="//cdn.jsdelivr.net"><link rel="preconnect" href="//busuanzi.ibruce.info"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.min.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={root:"/",algolia:void 0,localSearch:{path:"/search.xml",preload:!1,top_n_per_article:1,unescape:!1,languages:{hits_empty:"找不到您查询的内容：${query}",hits_stats:"共找到 ${hits} 篇文章"}},translate:void 0,noticeOutdate:void 0,highlight:{plugin:"highlighjs",highlightCopy:!0,highlightLang:!1,highlightHeightLimit:!1},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,post:!1},runtime:"",dateSuffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:void 0,lightbox:"fancybox",Snackbar:void 0,source:{justifiedGallery:{js:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.js",css:"https://cdn.jsdelivr.net/npm/flickr-justified-gallery/dist/fjGallery.min.css"}},isPhotoFigcaption:!1,islazyload:!1,isAnchor:!1,percent:{toc:!0,rightside:!1},autoDarkmode:!1}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={title:"前端项目搭建与后端部门管理实现（二）",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2023-10-28 00:05:58"}</script><noscript><style type="text/css">#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:function(e,t,a){0!==a&&(a=864e5*a,t={value:t,expiry:(new Date).getTime()+a},localStorage.setItem(e,JSON.stringify(t)))},get:function(e){var t=localStorage.getItem(e);if(t){t=JSON.parse(t);if(!((new Date).getTime()>t.expiry))return t.value;localStorage.removeItem(e)}}},e.getScript=o=>new Promise((t,e)=>{const a=document.createElement("script");a.src=o,a.async=!0,a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.getCSS=(o,n=!1)=>new Promise((t,e)=>{const a=document.createElement("link");a.rel="stylesheet",a.href=o,n&&(a.id=n),a.onerror=e,a.onload=a.onreadystatechange=function(){var e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(a.onload=a.onreadystatechange=null,t())},document.head.appendChild(a)}),e.activateDarkMode=function(){document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#0d0d0d")},e.activateLightMode=function(){document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#ffffff")};e=saveToLocal.get("theme"),"dark"===e?activateDarkMode():"light"===e&&activateLightMode(),e=saveToLocal.get("aside-status");void 0!==e&&("hide"===e?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/background.css"><meta name="generator" content="Hexo 6.3.0"></head><body><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src="/img/avatar.jpg" onerror='onerror=null,src="/img/friend_404.gif"' alt="avatar"></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">169</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">82</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">31</div></a></div><hr class="custom-hr"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image:url(/img/photo-1645943020355-305df166473d.jpg)"><nav id="nav"><span id="blog-info"><a href="/" title="清风"><span class="site-name">清风</span></a></span><div id="menus"><div id="search-button"><a class="site-page social-icon search" href="javascript:void(0);"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page group" href="javascript:void(0);"><i class="fa-fw fa fa-graduation-cap"></i><span> 博文</span><i class="fas fa-chevron-down"></i></a><ul class="menus_item_child"><li><a class="site-page child" href="/categories/"><i class="fa-fw fa fa-archive"></i><span> 分类</span></a></li><li><a class="site-page child" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 标签</span></a></li><li><a class="site-page child" href="/archives/"><i class="fa-fw fa fa-folder-open"></i><span> 归档</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于笔者</span></a></div></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">前端项目搭建与后端部门管理实现（二）</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-10-27T15:59:33.000Z" title="发表于 2023-10-27 23:59:33">2023-10-27</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-10-27T16:05:58.771Z" title="更新于 2023-10-28 00:05:58">2023-10-28</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE/">实战项目</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%AE%9E%E6%88%98%E9%A1%B9%E7%9B%AE/%E5%9F%BA%E7%A1%80%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86%E7%B3%BB%E7%BB%9F/">基础权限管理系统</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">7.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>37分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" data-flag-title="前端项目搭建与后端部门管理实现（二）"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h1 id="权限基础平台系统-部门管理"><a href="#权限基础平台系统-部门管理" class="headerlink" title="权限基础平台系统-部门管理"></a>权限基础平台系统-部门管理</h1><h2 id="内容"><a href="#内容" class="headerlink" title="内容"></a>内容</h2><ul><li>前端项目搭建</li><li>部门后端CRUD实现</li><li>跨域问题</li><li>前端-高级查询和分页</li><li>前端-删除</li><li>前端-部门添加和修改</li></ul><h2 id="一-前端项目搭建"><a href="#一-前端项目搭建" class="headerlink" title="一.前端项目搭建"></a>一.前端项目搭建</h2><p>vue-admin是一个基于Vue+ElementUI快速开发的管理系统模板，直接使用开发工具导入模板即可开发自己的管理界面。</p><p><img src="/breeze/58abc14f/2294018506.bmp" alt="img"></p><p>报错: sass npm ERR! <a href="mailto:&#110;&#111;&#100;&#101;&#45;&#115;&#97;&#x73;&#115;&#x40;&#52;&#x2e;&#x31;&#x34;&#x2e;&#x31;">&#110;&#111;&#100;&#101;&#45;&#115;&#97;&#x73;&#115;&#x40;&#52;&#x2e;&#x31;&#x34;&#x2e;&#x31;</a> postinstall: &#96;node scripts&#x2F;build.js</p><p>解决方案：npm config set sass_binary_site&#x3D;<a target="_blank" rel="noopener" href="https://npm.taobao.org/mirrors/node-sass">https://npm.taobao.org/mirrors/node-sass</a></p><h3 id="1-集成vue-admin"><a href="#1-集成vue-admin" class="headerlink" title="1.集成vue-admin"></a>1.集成vue-admin</h3><h4 id="1-1-IDEA导入模板"><a href="#1-1-IDEA导入模板" class="headerlink" title="1.1.IDEA导入模板"></a>1.1.IDEA导入模板</h4><p>使用IDEA的open功能导入模板</p><h4 id="1-2-安装插件"><a href="#1-2-安装插件" class="headerlink" title="1.2.安装插件"></a>1.2.安装插件</h4><p>建议你删除node_modules目录，然后执行： <code>npm install</code> 重新安装依赖库</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install</span><br></pre></td></tr></table></figure><p>你可以直接运行 npm run dev 来启动项目，因为模板中已经下载好所有的依赖库，但是如果你的Nodejs版本太高，启动会出现model找不到异常，建议先删除再安装。 如果安装太慢，可以使用 cnpm install</p><h4 id="1-3-启动项目"><a href="#1-3-启动项目" class="headerlink" title="1.3.启动项目"></a>1.3.启动项目</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm run dev</span><br></pre></td></tr></table></figure><h3 id="2-vue-admin调整"><a href="#2-vue-admin调整" class="headerlink" title="2.vue-admin调整"></a>2.vue-admin调整</h3><h4 id="2-1-注释mock代码"><a href="#2-1-注释mock代码" class="headerlink" title="2.1.注释mock代码"></a>2.1.注释mock代码</h4><p>我们直接使用自己的后台，不使用mockjs,修改main.js，注释掉下面代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//import Mock from &#x27;./mock&#x27;</span></span><br><span class="line"><span class="comment">//Mock.bootstrap();</span></span><br></pre></td></tr></table></figure><p>修改页面，比如： Table.vue 注释掉mockjs的引入</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;</span><br><span class="line">    <span class="comment">//import util from &#x27;../../common/js/util&#x27;</span></span><br><span class="line">    <span class="comment">//import NProgress from &#x27;nprogress&#x27;</span></span><br><span class="line">    <span class="comment">//import &#123; getUserListPage, removeUser, batchRemoveUser, editUser, addUser &#125; from &#x27;../../api/api&#x27;;</span></span><br></pre></td></tr></table></figure><h4 id="2-2-注释登录拦截代码"><a href="#2-2-注释登录拦截代码" class="headerlink" title="2.2.注释登录拦截代码"></a>2.2.注释登录拦截代码</h4><p>注释掉main.js中的router.beforeEach相关登录检查的代码，暂时不考虑登录</p><h4 id="2-3-引入axios代码"><a href="#2-3-引入axios代码" class="headerlink" title="2.3.引入axios代码"></a>2.3.引入axios代码</h4><p>在vue-admin已经install了axios，我们在main.js中引入，以后就在页面直接使用即可</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> axios <span class="keyword">from</span> <span class="string">&#x27;axios&#x27;</span></span><br><span class="line"><span class="comment">//配置axios的全局基本路径</span></span><br><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span>=<span class="string">&#x27;http://localhost:80/&#x27;</span></span><br><span class="line"><span class="comment">//全局属性配置，在任意组件内可以使用this.$http获取axios对象</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="property"><span class="keyword">prototype</span></span>.<span class="property">$http</span> = axios</span><br></pre></td></tr></table></figure><h4 id="2-4-注释掉登录代码"><a href="#2-4-注释掉登录代码" class="headerlink" title="2.4.注释掉登录代码"></a>2.4.注释掉登录代码</h4><p>修改login.vue登录代码修改为如下效果</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> loginParams = &#123; <span class="attr">username</span>: <span class="variable language_">this</span>.<span class="property">ruleForm2</span>.<span class="property">account</span>, <span class="attr">password</span>: <span class="variable language_">this</span>.<span class="property">ruleForm2</span>.<span class="property">checkPass</span> &#125;;</span><br><span class="line"><span class="variable language_">sessionStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;user&#x27;</span>, <span class="title class_">JSON</span>.<span class="title function_">stringify</span>(loginParams));</span><br><span class="line"><span class="variable language_">this</span>.<span class="property">$router</span>.<span class="title function_">push</span>(&#123; <span class="attr">path</span>: <span class="string">&#x27;/table&#x27;</span> &#125;);</span><br></pre></td></tr></table></figure><h3 id="3-认识vue-admin"><a href="#3-认识vue-admin" class="headerlink" title="3.认识vue-admin"></a>3.认识vue-admin</h3><p>这里我们对vue-admin做一个认识，了解一下它的目录结构，方便我们开发</p><h4 id="3-1-目录结构"><a href="#3-1-目录结构" class="headerlink" title="3.1.目录结构"></a>3.1.目录结构</h4><figure class="highlight dsconfig"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">vue-admin</span></span><br><span class="line">  |<span class="built_in">--build</span>                 <span class="comment"># 构建相关 </span></span><br><span class="line">  |<span class="built_in">--config</span>                <span class="comment"># 配置相关，如：config/index.js 包含了启动端口</span></span><br><span class="line">  |<span class="built_in">--dist</span>                  <span class="comment"># 打包后的资源目录</span></span><br><span class="line">  |<span class="built_in">--node_modules</span>          <span class="comment"># 下载的依赖库</span></span><br><span class="line">  |<span class="built_in">--src</span>				 <span class="comment"># 源代码</span></span><br><span class="line">  	  |<span class="built_in">--api</span>			 <span class="comment"># 封装了所有的请求</span></span><br><span class="line">  	  |<span class="built_in">--assets</span>           <span class="comment"># 主题 字体等静态资源</span></span><br><span class="line">  	  |<span class="built_in">--common</span>           <span class="comment"># 公共的JS</span></span><br><span class="line">  	  |<span class="built_in">--components</span>       <span class="comment"># 组件</span></span><br><span class="line">  	  |<span class="built_in">--mock</span>			 <span class="comment"># 项目mock 模拟数据</span></span><br><span class="line">  	  |<span class="built_in">--styles</span>			 <span class="comment"># 全局样式</span></span><br><span class="line">  	  |<span class="built_in">--views</span>			 <span class="comment"># 【重要】VUE页面</span></span><br><span class="line">            |<span class="built_in">--404.vue</span>	  <span class="comment"># 404页面找不到跳转</span></span><br><span class="line">            |<span class="built_in">--Home.vue</span>   <span class="comment">#【重要】主页，所有的子vue页面都加载到该页面，这个页面加载了菜单，顶部工具条等</span></span><br><span class="line">            |<span class="built_in">--Login.vue</span>  <span class="comment"># 登录页面</span></span><br><span class="line">            |<span class="built_in">--Main.vue</span>   <span class="comment"># 系统主页，可以展示一些报表，统计数据什么的</span></span><br><span class="line">   	  |<span class="built_in">--App.vue</span>		 <span class="comment"># 入口页面</span></span><br><span class="line">  	  |<span class="built_in">--main.js</span>		 <span class="comment"># 【重要】入口JS,可以在里面做一些公共的业务 ，如：加载组件 初始化等</span></span><br><span class="line">  	  |<span class="built_in">--routes.js</span>		 <span class="comment"># 【重要】路由JS，所有的页面跳转都在它里面配置</span></span><br><span class="line">  |<span class="built_in">--index.html</span>			 <span class="comment"># 入口页面，所有的页面都加入在该页面的 ，页面标题可以通过 &lt;title&gt;标题&lt;/title&gt;修改</span></span><br><span class="line">  |<span class="built_in">--package.json</span>         <span class="comment"># package.json：项目的版本管理文件，相当于是 pom.xml</span></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="3-2-标题修改"><a href="#3-2-标题修改" class="headerlink" title="3.2.标题修改"></a>3.2.标题修改</h4><p>修改index.html中的<code>&lt;title&gt;</code>权限基础平台系统<code>&lt;/title&gt;</code></p><h4 id="3-3-修改logo"><a href="#3-3-修改logo" class="headerlink" title="3.3.修改logo"></a>3.3.修改logo</h4><p>修改Home.vue中的data中的sysName</p><h4 id="3-4-main-js认识"><a href="#3-4-main-js认识" class="headerlink" title="3.4.main.js认识"></a>3.4.main.js认识</h4><p>main.js是入口js,可以做一些组件的初始化和公共的业务</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**======================================================================================</span></span><br><span class="line"><span class="comment"> * 内容说明： 导入vue和elementui相关</span></span><br><span class="line"><span class="comment"> ======================================================================================*/</span></span><br><span class="line"><span class="keyword">import</span> babelpolyfill <span class="keyword">from</span> <span class="string">&#x27;babel-polyfill&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vue</span> <span class="keyword">from</span> <span class="string">&#x27;vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">App</span> <span class="keyword">from</span> <span class="string">&#x27;./App&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">ElementUI</span> <span class="keyword">from</span> <span class="string">&#x27;element-ui&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;element-ui/lib/theme-chalk/index.css&#x27;</span></span><br><span class="line"><span class="comment">/**======================================================================================</span></span><br><span class="line"><span class="comment"> * 内容说明： 导入router路由相关</span></span><br><span class="line"><span class="comment"> ======================================================================================*/</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">VueRouter</span> <span class="keyword">from</span> <span class="string">&#x27;vue-router&#x27;</span></span><br><span class="line"><span class="keyword">import</span> store <span class="keyword">from</span> <span class="string">&#x27;./vuex/store&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Vuex</span> <span class="keyword">from</span> <span class="string">&#x27;vuex&#x27;</span></span><br><span class="line"><span class="keyword">import</span> routes <span class="keyword">from</span> <span class="string">&#x27;./routes&#x27;</span></span><br><span class="line"><span class="comment">/**======================================================================================</span></span><br><span class="line"><span class="comment"> * 内容说明： 导入mock测试，这个可以注释掉</span></span><br><span class="line"><span class="comment"> ======================================================================================*/</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Mock</span> <span class="keyword">from</span> <span class="string">&#x27;./mock&#x27;</span></span><br><span class="line"><span class="title class_">Mock</span>.<span class="title function_">bootstrap</span>();</span><br><span class="line"><span class="keyword">import</span> <span class="string">&#x27;font-awesome/css/font-awesome.min.css&#x27;</span></span><br><span class="line"><span class="comment">/**======================================================================================</span></span><br><span class="line"><span class="comment"> * 内容说明： 使用相关组件</span></span><br><span class="line"><span class="comment"> ======================================================================================*/</span></span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">ElementUI</span>)</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">VueRouter</span>)</span><br><span class="line"><span class="title class_">Vue</span>.<span class="title function_">use</span>(<span class="title class_">Vuex</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">/**======================================================================================</span></span><br><span class="line"><span class="comment"> * 内容说明： 路由配置</span></span><br><span class="line"><span class="comment"> ======================================================================================*/</span></span><br><span class="line"><span class="keyword">const</span> router = <span class="keyword">new</span> <span class="title class_">VueRouter</span>(&#123;</span><br><span class="line">  routes</span><br><span class="line">&#125;)</span><br><span class="line"><span class="comment">/**======================================================================================</span></span><br><span class="line"><span class="comment"> * 内容说明： 路由前置拦截器，用作登录检查</span></span><br><span class="line"><span class="comment"> ======================================================================================*/</span></span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">router.beforeEach((to, from, next) =&gt; &#123;</span></span><br><span class="line"><span class="comment">  //NProgress.start();</span></span><br><span class="line"><span class="comment">  if (to.path == &#x27;/login&#x27;) &#123;</span></span><br><span class="line"><span class="comment">    sessionStorage.removeItem(&#x27;user&#x27;);</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">  let user = JSON.parse(sessionStorage.getItem(&#x27;user&#x27;));</span></span><br><span class="line"><span class="comment">  if (!user &amp;&amp; to.path != &#x27;/login&#x27;) &#123;</span></span><br><span class="line"><span class="comment">    next(&#123; path: &#x27;/login&#x27; &#125;)</span></span><br><span class="line"><span class="comment">  &#125; else &#123;</span></span><br><span class="line"><span class="comment">    next()</span></span><br><span class="line"><span class="comment">  &#125;</span></span><br><span class="line"><span class="comment">&#125;)</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="comment">/**======================================================================================</span></span><br><span class="line"><span class="comment"> * 内容说明： 创建Vue对象，挂载 #app元素 ， 见Vue.app</span></span><br><span class="line"><span class="comment"> ======================================================================================*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">new</span> <span class="title class_">Vue</span>(&#123;</span><br><span class="line">  <span class="comment">//el: &#x27;#app&#x27;,</span></span><br><span class="line">  <span class="comment">//template: &#x27;&lt;App/&gt;&#x27;,</span></span><br><span class="line">  router,</span><br><span class="line">  store,</span><br><span class="line">  <span class="comment">//components: &#123; App &#125;</span></span><br><span class="line">  <span class="attr">render</span>: <span class="function"><span class="params">h</span> =&gt;</span> <span class="title function_">h</span>(<span class="title class_">App</span>)</span><br><span class="line">&#125;).$mount(<span class="string">&#x27;#app&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure><h4 id="3-5-认识routes-js"><a href="#3-5-认识routes-js" class="headerlink" title="3.5.认识routes.js"></a>3.5.认识routes.js</h4><p>routes.js中是所有的页面的路由，即：浏览器访问什么样的地址，跳转什么样的vue页面</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/**======================================================================================</span></span><br><span class="line"><span class="comment"> * 内容说明：导入页面</span></span><br><span class="line"><span class="comment"> ======================================================================================*/</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Login</span> <span class="keyword">from</span> <span class="string">&#x27;./views/Login.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">NotFound</span> <span class="keyword">from</span> <span class="string">&#x27;./views/404.vue&#x27;</span></span><br><span class="line"><span class="keyword">import</span> <span class="title class_">Home</span> <span class="keyword">from</span> <span class="string">&#x27;./views/Home.vue&#x27;</span></span><br><span class="line">    ...省略...</span><br><span class="line">    <span class="comment">/**======================================================================================</span></span><br><span class="line"><span class="comment"> * 内容说明：把页面加入路由</span></span><br><span class="line"><span class="comment"> ======================================================================================*/</span></span><br><span class="line">    <span class="keyword">let</span> routes = [</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">//页面访问路径</span></span><br><span class="line">            <span class="attr">path</span>: <span class="string">&#x27;/login&#x27;</span>,</span><br><span class="line">            <span class="comment">//访问上面路径，展示component对应的页面</span></span><br><span class="line">            <span class="attr">component</span>: <span class="title class_">Login</span>,</span><br><span class="line">            <span class="comment">//给页面取名字，该名字用来在左侧菜单中展示的标题</span></span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">            <span class="comment">//是否隐藏菜单，如果true,就不会在左侧菜单中显示</span></span><br><span class="line">            <span class="attr">hidden</span>: <span class="literal">true</span></span><br><span class="line">        &#125;,</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">            <span class="attr">component</span>: <span class="title class_">Home</span>,</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;导航一&#x27;</span>,</span><br><span class="line">            <span class="comment">//给菜单一个图标</span></span><br><span class="line">            <span class="attr">iconCls</span>: <span class="string">&#x27;el-icon-message&#x27;</span>,</span><br><span class="line">            <span class="comment">//菜单下的子菜单</span></span><br><span class="line">            <span class="attr">children</span>: [</span><br><span class="line">                &#123; <span class="attr">path</span>: <span class="string">&#x27;/main&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Main</span>, <span class="attr">name</span>: <span class="string">&#x27;主页&#x27;</span>, <span class="attr">hidden</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">path</span>: <span class="string">&#x27;/table&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Table</span>, <span class="attr">name</span>: <span class="string">&#x27;表格&#x27;</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">path</span>: <span class="string">&#x27;/form&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Form</span>, <span class="attr">name</span>: <span class="string">&#x27;Form&#x27;</span> &#125;,</span><br><span class="line">                &#123; <span class="attr">path</span>: <span class="string">&#x27;/user&#x27;</span>, <span class="attr">component</span>: user, <span class="attr">name</span>: <span class="string">&#x27;列表&#x27;</span> &#125;,</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">        ...省略...</span><br></pre></td></tr></table></figure><h2 id="二-后端部门的CRUD实现"><a href="#二-后端部门的CRUD实现" class="headerlink" title="二.后端部门的CRUD实现"></a>二.后端部门的CRUD实现</h2><h3 id="1-部门增删改实现"><a href="#1-部门增删改实现" class="headerlink" title="1.部门增删改实现"></a>1.部门增删改实现</h3><p>调整domain</p><p>增加Employee</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Employee</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String username;</span><br><span class="line">    <span class="keyword">private</span> String password;</span><br><span class="line">    <span class="keyword">private</span> String email;</span><br><span class="line">    <span class="keyword">private</span> String headImage;</span><br><span class="line">    <span class="keyword">private</span> Integer age;</span><br><span class="line">    <span class="keyword">private</span> Department department;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>修改Department</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.domain;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.Date;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">Department</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Long id;</span><br><span class="line">    <span class="keyword">private</span> String name;</span><br><span class="line">    <span class="keyword">private</span> String intro;</span><br><span class="line">    <span class="keyword">private</span> Date create_time;</span><br><span class="line">    <span class="keyword">private</span> Date update_time;</span><br><span class="line">    <span class="keyword">private</span> Employee manager;</span><br><span class="line">    <span class="keyword">private</span> Department parent;</span><br><span class="line">    <span class="keyword">private</span> String path;</span><br><span class="line">    <span class="keyword">private</span> Integer state;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>DepartmentMapper</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.mliutm.domain.Department;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DepartmentMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;Department&gt; <span class="title function_">loadAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">removeById</span><span class="params">(Serializable id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(Department department)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Department department)</span>;</span><br><span class="line"></span><br><span class="line">    Department <span class="title function_">loadById</span><span class="params">(Serializable id)</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>DepartmentMapper.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?xml version=<span class="string">&quot;1.0&quot;</span> encoding=<span class="string">&quot;UTF-8&quot;</span> ?&gt;</span></span><br><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">mapper</span> <span class="keyword">PUBLIC</span> <span class="string">&quot;-//mybatis.org//DTD Mapper 3.0//EN&quot;</span> <span class="string">&quot;http://mybatis.org/dtd/mybatis-3-mapper.dtd&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">mapper</span> <span class="attr">namespace</span>=<span class="string">&quot;cn.mliutm.mapper.DepartmentMapper&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">insert</span> <span class="attr">id</span>=<span class="string">&quot;insert&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Department&quot;</span>&gt;</span></span><br><span class="line">        insert into t_department(</span><br><span class="line">        name,</span><br><span class="line">        intro,</span><br><span class="line">        create_time,</span><br><span class="line">        update_time,</span><br><span class="line">        manager_id,</span><br><span class="line">        parent_id,</span><br><span class="line">        path,</span><br><span class="line">        state</span><br><span class="line">        )value(</span><br><span class="line">        #&#123;name&#125;,</span><br><span class="line">        #&#123;intro&#125;,</span><br><span class="line">        #&#123;create_time&#125;,</span><br><span class="line">        #&#123;update_time&#125;,</span><br><span class="line">        #&#123;manager.id&#125;,</span><br><span class="line">        #&#123;parent.id&#125;,</span><br><span class="line">        #&#123;path&#125;,</span><br><span class="line">        #&#123;state&#125;</span><br><span class="line">        )</span><br><span class="line">    <span class="tag">&lt;/<span class="name">insert</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">update</span> <span class="attr">id</span>=<span class="string">&quot;update&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Department&quot;</span>&gt;</span></span><br><span class="line">        update t_department set</span><br><span class="line">        name = #&#123;name&#125;,</span><br><span class="line">        intro = #&#123;intro&#125;,</span><br><span class="line">        create_time = #&#123;create_time&#125;,</span><br><span class="line">        update_time = #&#123;update_time&#125;,</span><br><span class="line">        manager_id = #&#123;manager.id&#125;,</span><br><span class="line">        parent_id = #&#123;parent.id&#125;,</span><br><span class="line">        path = #&#123;path&#125;,</span><br><span class="line">        state = #&#123;state&#125;</span><br><span class="line">        where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">update</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">delete</span> <span class="attr">id</span>=<span class="string">&quot;removeById&quot;</span>&gt;</span></span><br><span class="line">        delete from t_department where id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">delete</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;loadAll&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;BaseResultMap&quot;</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">        c.*,</span><br><span class="line">        e.id AS eid,</span><br><span class="line">        e.username AS eusername,</span><br><span class="line">        p.id AS pid,</span><br><span class="line">        p.NAME AS pname</span><br><span class="line">        FROM</span><br><span class="line">        t_department c</span><br><span class="line">        LEFT JOIN t_employee e ON c.manager_id = e.id</span><br><span class="line">        LEFT JOIN t_department p ON c.parent_id = p.id</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;loadById&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;Long&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;BaseResultMap&quot;</span>&gt;</span></span><br><span class="line">        SELECT</span><br><span class="line">        c.*,</span><br><span class="line">        e.id AS eid,</span><br><span class="line">        e.username AS eusername,</span><br><span class="line">        p.id AS pid,</span><br><span class="line">        p.NAME AS pname</span><br><span class="line">        FROM</span><br><span class="line">        t_department c</span><br><span class="line">        LEFT JOIN t_employee e ON c.manager_id = e.id</span><br><span class="line">        LEFT JOIN t_department p ON c.parent_id = p.id</span><br><span class="line">        where c.id = #&#123;id&#125;</span><br><span class="line">    <span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">resultMap</span> <span class="attr">id</span>=<span class="string">&quot;BaseResultMap&quot;</span> <span class="attr">type</span>=<span class="string">&quot;Department&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;id&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;name&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;intro&quot;</span> <span class="attr">column</span>=<span class="string">&quot;intro&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;create_time&quot;</span> <span class="attr">column</span>=<span class="string">&quot;create_time&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;update_time&quot;</span> <span class="attr">column</span>=<span class="string">&quot;update_time&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;path&quot;</span> <span class="attr">column</span>=<span class="string">&quot;path&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;state&quot;</span> <span class="attr">column</span>=<span class="string">&quot;state&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;manager&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Employee&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;username&quot;</span> <span class="attr">column</span>=<span class="string">&quot;eusername&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">association</span> <span class="attr">property</span>=<span class="string">&quot;parent&quot;</span> <span class="attr">javaType</span>=<span class="string">&quot;Department&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span> <span class="attr">property</span>=<span class="string">&quot;id&quot;</span> <span class="attr">column</span>=<span class="string">&quot;pid&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">result</span> <span class="attr">property</span>=<span class="string">&quot;name&quot;</span> <span class="attr">column</span>=<span class="string">&quot;pname&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">result</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">association</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">resultMap</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">mapper</span>&gt;</span></span><br></pre></td></tr></table></figure><p>IDepartmentService</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.mliutm.domain.Department;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IDepartmentService</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;Department&gt; <span class="title function_">getAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Department department)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Department department)</span>;</span><br><span class="line"></span><br><span class="line">    Department <span class="title function_">getById</span><span class="params">(Long id)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>DepartmentServiceImpl</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.mliutm.domain.Department;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.mapper.DepartmentMapper;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.service.IDepartmentService;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Propagation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Transactional(readOnly = true,propagation = Propagation.SUPPORTS)</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DepartmentServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">IDepartmentService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DepartmentMapper departmentMapper;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> List&lt;Department&gt; <span class="title function_">getAll</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> departmentMapper.loadAll();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">deleteById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        departmentMapper.removeById(id);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Department department)</span> &#123;</span><br><span class="line">        departmentMapper.insert(department);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Transactional</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Department department)</span> &#123;</span><br><span class="line">        departmentMapper.update(department);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> Department <span class="title function_">getById</span><span class="params">(Long id)</span> &#123;</span><br><span class="line">        <span class="keyword">return</span> departmentMapper.loadById(id);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>DepartmentController</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.mliutm.domain.Department;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.service.IDepartmentService;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.utils.AjaxResult;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/department&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DepartmentController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IDepartmentService departmentService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 新增或修改的保存操作</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> department</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">addOrUpdate</span><span class="params">(<span class="meta">@RequestBody</span> Department department)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(Objects.isNull(department.getId()))&#123;</span><br><span class="line">                departmentService.add(department);</span><br><span class="line">            &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                departmentService.update(department);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> AjaxResult.me().setSuccess(<span class="literal">false</span>).setMessage(<span class="string">&quot;保存失败!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> AjaxResult.me();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据ID删除</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@DeleteMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">delById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span>Long id)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            departmentService.deleteById(id);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> AjaxResult.me().setSuccess(<span class="literal">false</span>).setMessage(<span class="string">&quot;删除失败!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> AjaxResult.me();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 根据ID查询</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> id</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping(&quot;/&#123;id&#125;&quot;)</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">getById</span><span class="params">(<span class="meta">@PathVariable(&quot;id&quot;)</span>Long id)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="type">Department</span> <span class="variable">department</span> <span class="operator">=</span> departmentService.getById(id);</span><br><span class="line">            <span class="keyword">return</span> AjaxResult.me().setData(department);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> AjaxResult.me().setSuccess(<span class="literal">false</span>).setMessage(<span class="string">&quot;查询失败!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 查询所有</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@GetMapping</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">getAll</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            List&lt;Department&gt; departments = departmentService.getAll();</span><br><span class="line">            <span class="keyword">return</span> AjaxResult.me().setData(departments);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> AjaxResult.me().setSuccess(<span class="literal">false</span>).setMessage(<span class="string">&quot;查询失败!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>swagger测试</p><p><a target="_blank" rel="noopener" href="http://localhost:8080/swagger-ui.html">http://localhost:8080/swagger-ui.html</a></p><h3 id="2-部门分页实现"><a href="#2-部门分页实现" class="headerlink" title="2.部门分页实现"></a>2.部门分页实现</h3><h4 id="1-分页概述"><a href="#1-分页概述" class="headerlink" title="1 分页概述"></a>1 分页概述</h4><h5 id="1-1-为什么需要分页"><a href="#1-1-为什么需要分页" class="headerlink" title="1.1 为什么需要分页"></a>1.1 为什么需要分页</h5><p>​ 如果数据过多，一个页面放不下，或者能放下，也不太好看。分页查找。</p><h5 id="1-2-分页的分类"><a href="#1-2-分页的分类" class="headerlink" title="1.2 分页的分类"></a>1.2 分页的分类</h5><p>​ 1）真分页–<strong>物理分页</strong>（数据库分页）—-<strong>采纳</strong></p><p>​ 每次都只从数据库查询出特定条数数据 mysql:limit begin,pageSize。相较于假分页，第一次效率高，但是后面每次都要查询数据库效率低。</p><p>​ 2）假分页–<strong>逻辑分页</strong></p><p>​ 假分页一次性从数据库全部查询出来给前端，前端分页显示。第一次一次性要加载全部数据，比较慢，尤其数据量大的情况下，很容易卡死。但是如果数据量，后续访问就不用访问数据库，效率高。</p><h4 id="2-分页实现"><a href="#2-分页实现" class="headerlink" title="2.分页实现"></a>2.分页实现</h4><h5 id="2-1-思路分析"><a href="#2-1-思路分析" class="headerlink" title="2.1 思路分析"></a>2.1 思路分析</h5><p><img src="/breeze/58abc14f/1659426174475.png"></p><p><img src="/breeze/58abc14f/1659427608211.png"></p><h5 id="2-2-封装Query和PageList"><a href="#2-2-封装Query和PageList" class="headerlink" title="2.2 封装Query和PageList"></a>2.2 封装Query和PageList</h5><p>DepartmentQuery</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.query;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DepartmentQuery</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当前页</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">currentPage</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 每页显示条数</span></span><br><span class="line">    <span class="keyword">private</span> Integer pageSize= <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取起始条数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getStart</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">this</span>.currentPage-<span class="number">1</span>)*<span class="built_in">this</span>.pageSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>PageList</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.utils;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.AllArgsConstructor;</span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"><span class="keyword">import</span> lombok.NoArgsConstructor;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="meta">@AllArgsConstructor</span></span><br><span class="line"><span class="meta">@NoArgsConstructor</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">PageList</span>&lt;T&gt; &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 总条数</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Long</span> <span class="variable">total</span> <span class="operator">=</span> <span class="number">0L</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 当前页数据</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> List&lt;T&gt; rows = <span class="keyword">new</span> <span class="title class_">ArrayList</span>&lt;&gt;();</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="2-3-service"><a href="#2-3-service" class="headerlink" title="2.3 service"></a>2.3 service</h5><p>IDepartmentService</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.service;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.mliutm.domain.Department;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.query.DepartmentQuery;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.utils.PageList;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">IDepartmentService</span> &#123;</span><br><span class="line"></span><br><span class="line">    PageList&lt;Department&gt; <span class="title function_">pageList</span><span class="params">(DepartmentQuery query)</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>DepartmentServiceImpl</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.service.impl;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.mliutm.domain.Department;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.mapper.DepartmentMapper;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.query.DepartmentQuery;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.service.IDepartmentService;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.utils.PageList;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.stereotype.Service;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Propagation;</span><br><span class="line"><span class="keyword">import</span> org.springframework.transaction.annotation.Transactional;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Transactional(readOnly = true,propagation = Propagation.SUPPORTS)</span></span><br><span class="line"><span class="meta">@Service</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DepartmentServiceImpl</span> <span class="keyword">implements</span> <span class="title class_">IDepartmentService</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> DepartmentMapper departmentMapper;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 分页查询</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> query</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="keyword">public</span> PageList&lt;Department&gt; <span class="title function_">pageList</span><span class="params">(DepartmentQuery query)</span> &#123;</span><br><span class="line">        <span class="comment">// 查询总条数</span></span><br><span class="line">        <span class="type">long</span> <span class="variable">total</span> <span class="operator">=</span> departmentMapper.loadTotal(query);</span><br><span class="line">        <span class="keyword">if</span>(total &gt; <span class="number">0</span>)&#123;</span><br><span class="line">            List&lt;Department&gt; rows = departmentMapper.loadData(query);</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PageList</span>&lt;&gt;(total,rows);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">PageList</span>&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h5 id="2-4-mapper"><a href="#2-4-mapper" class="headerlink" title="2.4 mapper"></a>2.4 mapper</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.mapper;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.mliutm.domain.Department;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.query.DepartmentQuery;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.io.Serializable;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title class_">DepartmentMapper</span> &#123;</span><br><span class="line"></span><br><span class="line">    List&lt;Department&gt; <span class="title function_">loadAll</span><span class="params">()</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">removeById</span><span class="params">(Serializable id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">insert</span><span class="params">(Department department)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Department department)</span>;</span><br><span class="line"></span><br><span class="line">    Department <span class="title function_">loadById</span><span class="params">(Serializable id)</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//===================分页查询====================================</span></span><br><span class="line">    <span class="type">long</span> <span class="title function_">loadTotal</span><span class="params">(DepartmentQuery query)</span>;</span><br><span class="line"></span><br><span class="line">    List&lt;Department&gt; <span class="title function_">loadData</span><span class="params">(DepartmentQuery query)</span>;</span><br><span class="line">    <span class="comment">//===================分页查询====================================</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>DepartmentMapper.xml</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--=====================分页查询实现=====================--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;loadTotal&quot;</span> <span class="attr">resultType</span>=<span class="string">&quot;Long&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;DepartmentQuery&quot;</span>&gt;</span></span><br><span class="line">    SELECT</span><br><span class="line">    count(*)</span><br><span class="line">    FROM</span><br><span class="line">    t_department c</span><br><span class="line">    LEFT JOIN t_employee e ON c.manager_id = e.id</span><br><span class="line">    LEFT JOIN t_department p ON c.parent_id = p.id</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;loadData&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;BaseResultMap&quot;</span> <span class="attr">parameterType</span>=<span class="string">&quot;DepartmentQuery&quot;</span>&gt;</span></span><br><span class="line">    SELECT</span><br><span class="line">    c.*,</span><br><span class="line">    e.id AS eid,</span><br><span class="line">    e.username AS eusername,</span><br><span class="line">    p.id AS pid,</span><br><span class="line">    p.NAME AS pname</span><br><span class="line">    FROM</span><br><span class="line">    t_department c</span><br><span class="line">    LEFT JOIN t_employee e ON c.manager_id = e.id</span><br><span class="line">    LEFT JOIN t_department p ON c.parent_id = p.id</span><br><span class="line">    limit #&#123;start&#125;,#&#123;pageSize&#125;</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--=====================分页查询实现=====================--&gt;</span></span><br></pre></td></tr></table></figure><h5 id="2-5-junit测试service"><a href="#2-5-junit测试service" class="headerlink" title="2.5 junit测试service"></a>2.5 junit测试service</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Test</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">pageList</span><span class="params">()</span> &#123;</span><br><span class="line">    <span class="type">DepartmentQuery</span> <span class="variable">query</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">DepartmentQuery</span>();</span><br><span class="line">    query.setCurrentPage(<span class="number">1</span>);</span><br><span class="line">    query.setPageSize(<span class="number">2</span>);</span><br><span class="line">    PageList&lt;Department&gt; pageList = departmentService.pageList(query);</span><br><span class="line">    System.out.println(<span class="string">&quot;总条数:&quot;</span>+pageList.getTotal());</span><br><span class="line">    System.out.println(<span class="string">&quot;当前页数据:&quot;</span>);</span><br><span class="line">    pageList.getRows().forEach(System.out::println);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h5 id="2-6-controller"><a href="#2-6-controller" class="headerlink" title="2.6 controller"></a>2.6 controller</h5><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.controller;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> cn.mliutm.domain.Department;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.query.DepartmentQuery;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.service.IDepartmentService;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.utils.AjaxResult;</span><br><span class="line"><span class="keyword">import</span> cn.mliutm.utils.PageList;</span><br><span class="line"><span class="keyword">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.bind.annotation.*;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"><span class="keyword">import</span> java.util.Objects;</span><br><span class="line"></span><br><span class="line"><span class="meta">@RestController</span></span><br><span class="line"><span class="meta">@RequestMapping(&quot;/department&quot;)</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DepartmentController</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="meta">@Autowired</span></span><br><span class="line">    <span class="keyword">private</span> IDepartmentService departmentService;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 分页实现</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@param</span> query</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="meta">@PostMapping</span></span><br><span class="line">    <span class="keyword">public</span> AjaxResult <span class="title function_">pageList</span><span class="params">(<span class="meta">@RequestBody</span> DepartmentQuery query)</span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            PageList&lt;Department&gt; pageList = departmentService.pageList(query);</span><br><span class="line">            <span class="keyword">return</span> AjaxResult.me().setData(pageList);</span><br><span class="line">        &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">            e.printStackTrace();</span><br><span class="line">            <span class="keyword">return</span> AjaxResult.me().setSuccess(<span class="literal">false</span>).setMessage(<span class="string">&quot;分页查询失败&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="三-前端部门分页列表"><a href="#三-前端部门分页列表" class="headerlink" title="三.前端部门分页列表"></a>三.前端部门分页列表</h2><h3 id="1-页面准备"><a href="#1-页面准备" class="headerlink" title="1.页面准备"></a>1.页面准备</h3><ul><li>拷贝table.vue页面,重命名为 Department.vue</li><li>修改routes.js ，增加Department.vue的路由配置</li></ul><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="title class_">Department</span> <span class="keyword">from</span> <span class="string">&quot;./views/org/Department&quot;</span>;</span><br><span class="line">&#123;</span><br><span class="line">    <span class="attr">path</span>: <span class="string">&#x27;/&#x27;</span>,</span><br><span class="line">        <span class="attr">component</span>: <span class="title class_">Home</span>,</span><br><span class="line">            <span class="attr">name</span>: <span class="string">&#x27;组织机构管理&#x27;</span>,</span><br><span class="line">                <span class="attr">iconCls</span>: <span class="string">&#x27;el-icon-message&#x27;</span>,<span class="comment">//图标样式class</span></span><br><span class="line">                    <span class="attr">children</span>: [</span><br><span class="line">                        &#123; <span class="attr">path</span>: <span class="string">&#x27;/department&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Department</span>, <span class="attr">name</span>: <span class="string">&#x27;部门管理&#x27;</span>, <span class="attr">hidden</span>: <span class="literal">true</span> &#125;,</span><br><span class="line">                        &#123; <span class="attr">path</span>: <span class="string">&#x27;/table&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Table</span>, <span class="attr">name</span>: <span class="string">&#x27;Table&#x27;</span> &#125;,</span><br><span class="line">                        &#123; <span class="attr">path</span>: <span class="string">&#x27;/form&#x27;</span>, <span class="attr">component</span>: <span class="title class_">Form</span>, <span class="attr">name</span>: <span class="string">&#x27;Form&#x27;</span> &#125;,</span><br><span class="line">                        &#123; <span class="attr">path</span>: <span class="string">&#x27;/user&#x27;</span>, <span class="attr">component</span>: user, <span class="attr">name</span>: <span class="string">&#x27;列表&#x27;</span> &#125;,</span><br><span class="line">                    ]</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><ul><li><p>调整页面</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--列表--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-table</span> <span class="attr">:data</span>=<span class="string">&quot;pageInfo.rows&quot;</span> <span class="attr">highlight-current-row</span> <span class="attr">v-loading</span>=<span class="string">&quot;listLoading&quot;</span> @<span class="attr">selection-change</span>=<span class="string">&quot;selsChange&quot;</span> <span class="attr">style</span>=<span class="string">&quot;width: 100%;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">type</span>=<span class="string">&quot;selection&quot;</span> <span class="attr">width</span>=<span class="string">&quot;55&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">type</span>=<span class="string">&quot;index&quot;</span> <span class="attr">width</span>=<span class="string">&quot;60&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;name&quot;</span> <span class="attr">label</span>=<span class="string">&quot;名字&quot;</span> <span class="attr">width</span>=<span class="string">&quot;120&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;create_time&quot;</span> <span class="attr">label</span>=<span class="string">&quot;创建时间&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;update_time&quot;</span> <span class="attr">label</span>=<span class="string">&quot;修改时间&quot;</span> <span class="attr">width</span>=<span class="string">&quot;100&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;manager.username&quot;</span> <span class="attr">label</span>=<span class="string">&quot;部门经理&quot;</span> <span class="attr">width</span>=<span class="string">&quot;120&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;parent.name&quot;</span> <span class="attr">label</span>=<span class="string">&quot;父部门&quot;</span> <span class="attr">min-width</span>=<span class="string">&quot;180&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;path&quot;</span> <span class="attr">label</span>=<span class="string">&quot;部门路径&quot;</span> <span class="attr">width</span>=<span class="string">&quot;120&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;state&quot;</span> <span class="attr">label</span>=<span class="string">&quot;状态&quot;</span> <span class="attr">min-width</span>=<span class="string">&quot;180&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&quot;scope.row.state == 0&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color: red;&quot;</span>&gt;</span>禁用<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&quot;scope.row.state == 1&quot;</span>&gt;</span>启用<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;intro&quot;</span> <span class="attr">label</span>=<span class="string">&quot;描述&quot;</span> <span class="attr">width</span>=<span class="string">&quot;120&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">width</span>=<span class="string">&quot;150&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">template</span> <span class="attr">scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleEdit(scope.$index, scope.row)&quot;</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleDel(scope.$index, scope.row)&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-table</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">&lt;!--工具条--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;24&quot;</span> <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;batchRemove&quot;</span> <span class="attr">:disabled</span>=<span class="string">&quot;this.sels.length===0&quot;</span>&gt;</span>批量删除<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-pagination</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">layout</span>=<span class="string">&quot;total, prev, pager, next&quot;</span></span></span><br><span class="line"><span class="tag">                   @<span class="attr">current-change</span>=<span class="string">&quot;handleCurrentChange&quot;</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">:page-size</span>=<span class="string">&quot;10&quot;</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">:total</span>=<span class="string">&quot;pageInfo.total&quot;</span></span></span><br><span class="line"><span class="tag">                   <span class="attr">style</span>=<span class="string">&quot;float:right;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-pagination</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">export</span> <span class="keyword">default</span> &#123;</span><br><span class="line">    <span class="title function_">data</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">pageInfo</span>:&#123;</span><br><span class="line">                <span class="attr">total</span>:<span class="number">0</span>,</span><br><span class="line">                <span class="attr">rows</span>:[]</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">query</span>:&#123;</span><br><span class="line">                <span class="attr">currentPage</span>:<span class="number">1</span>,</span><br><span class="line">                <span class="attr">pageSize</span>:<span class="number">10</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="attr">methods</span>: &#123;</span><br><span class="line">        <span class="title function_">handleCurrentChange</span>(<span class="params">val</span>) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">query</span>.<span class="property">currentPage</span> = val;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">getDepartment</span>();</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="title function_">getDepartment</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">post</span>(<span class="string">&quot;/department&quot;</span>,<span class="variable language_">this</span>.<span class="property">query</span>)</span><br><span class="line">                .<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">                result = result.<span class="property">data</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">pageInfo</span> = result.<span class="property">data</span>;</span><br><span class="line">            &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.$message(&#123; <span class="attr">message</span>: <span class="string">&#x27;分页查询失败&#x27;</span>,<span class="attr">type</span>: <span class="string">&#x27;error&#x27;</span>&#125;);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    <span class="title function_">mounted</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="title function_">getDepartment</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>测试访问–报错</p><p><img src="/breeze/58abc14f/1641464329145.png" alt="1641464329145"></p></li></ul><p>以上就是今日重点：跨越问题</p><h2 id="四-跨域问题"><a href="#四-跨域问题" class="headerlink" title="四.跨域问题"></a>四.跨域问题</h2><h3 id="1-跨域理解"><a href="#1-跨域理解" class="headerlink" title="1.跨域理解"></a>1.跨域理解</h3><blockquote><p>Access to XMLHttpRequest at ‘<a target="_blank" rel="noopener" href="http://localhost/dept/page">http://localhost:80/dept/page</a>‘ from origin ‘<a target="_blank" rel="noopener" href="http://localhost:8080/">http://localhost:8080</a>‘ has been blocked by CORS policy: Response to preflight request doesn’t pass access control check: No ‘Access-Control-Allow-Origin’ header is present on the requested resource.</p></blockquote><p>‘访问’<a target="_blank" rel="noopener" href="http://localhost/dept/page'%E6%9D%A5%E6%BA%90'http://localhost%EF%BC%9A8080'%E5%B7%B2%E8%A2%ABCORS%E7%AD%96%E7%95%A5%E9%98%BB%E6%AD%A2%EF%BC%9A%E5%AF%B9%E5%BD%93%E5%89%8D%E8%AF%B7%E6%B1%82%E7%9A%84%E5%93%8D%E5%BA%94%E6%9C%AA%E9%80%9A%E8%BF%87%E8%AE%BF%E9%97%AE%E6%8E%A7%E5%88%B6%E6%A3%80%E6%9F%A5%EF%BC%9A%E8%AF%B7%E6%B1%82%E7%9A%84%E8%B5%84%E6%BA%90%E4%B8%8A%E4%B8%8D%E5%AD%98%E5%9C%A8'access">http://localhost:80/dept/page&#39;来源&#39;http://localhost：8080&#39;已被CORS策略阻止：对当前请求的响应未通过访问控制检查：请求的资源上不存在&#39;access</a> control Allow Origin’标头。</p><h4 id="1-1-什么是跨域"><a href="#1-1-什么是跨域" class="headerlink" title="1.1.什么是跨域"></a>1.1.什么是跨域</h4><p>[JS跨域名访问] : 前后台分离之后，和以往不同的是，前后台采用了不同的服务器去运行以及部署，也就是说前端，后台有了不同的域名，也就造成了<code>在js中访问另外一个域名</code>的情况，试想一下如果不做任何限制，那是不是任何一个客户端都可以伪造身份来访问你的后台呢，所以出于安全考虑，几乎所有的浏览器就禁止JS跨域名访问。</p><p><img src="/breeze/58abc14f/image-20210606113834060.png" alt="image-20210606113834060"></p><h4 id="1-2-跨域的条件"><a href="#1-2-跨域的条件" class="headerlink" title="1.2.跨域的条件"></a>1.2.跨域的条件</h4><p><code>【注意】域名不一致(locahos和127.0.0.1是不一致的) 或 请求协议不一致 或 端口 不一致 都视为跨域，且跨域只针对于ajax请求</code></p><table><thead><tr><th align="left">URL</th><th align="left">说明</th><th align="left">是否允许通信</th></tr></thead><tbody><tr><td align="left"><a target="_blank" rel="noopener" href="http://www.a.com/a.js">http://www.a.com/a.js</a> ；<a target="_blank" rel="noopener" href="http://www.a.com/b.js">http://www.a.com/b.js</a></td><td align="left">同一域名下</td><td align="left">允许</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="http://www.a.com/lab/a.js%EF%BC%9B">http://www.a.com/lab/a.js；</a> <a target="_blank" rel="noopener" href="http://www.a.com/script/b.js">http://www.a.com/script/b.js</a></td><td align="left">同一域名下不同文件夹</td><td align="left">允许</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="http://www.a.com:8000/a.js%EF%BC%9B">http://www.a.com:8000/a.js；</a> <a target="_blank" rel="noopener" href="http://www.a.com/b.js">http://www.a.com/b.js</a></td><td align="left">同一域名，不同端口</td><td align="left">不允许</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="http://www.a.com/a.js">http://www.a.com/a.js</a> ；<a target="_blank" rel="noopener" href="https://www.a.com/b.js">https://www.a.com/b.js</a></td><td align="left">同一域名，不同协议</td><td align="left">不允许</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="http://www.a.com/a.js">http://www.a.com/a.js</a> ；<a target="_blank" rel="noopener" href="http://70.32.92.74/b.js">http://70.32.92.74/b.js</a></td><td align="left">域名和域名对应ip</td><td align="left">不允许</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="http://www.a.com/a.js">http://www.a.com/a.js</a> ；<a target="_blank" rel="noopener" href="http://script.a.com/b.js">http://script.a.com/b.js</a></td><td align="left">主域相同，子域不同</td><td align="left">不允许</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="http://www.a.com/a.js%EF%BC%9B">http://www.a.com/a.js；</a> <a target="_blank" rel="noopener" href="http://a.com/b.js">http://a.com/b.js</a></td><td align="left">同一域名，不同二级域名（同上）</td><td align="left">不允许</td></tr><tr><td align="left"><a target="_blank" rel="noopener" href="http://www.cnblogs.com/a.js">http://www.cnblogs.com/a.js</a> ；<a target="_blank" rel="noopener" href="http://www.a.com/b.js">http://www.a.com/b.js</a></td><td align="left">不同域名</td><td align="left">不允许</td></tr></tbody></table><h3 id="2-解决跨域"><a href="#2-解决跨域" class="headerlink" title="2.解决跨域"></a>2.解决跨域</h3><p>跨域解决方案有很多，见：<a target="_blank" rel="noopener" href="https://www.imooc.com/article/291931">https://www.imooc.com/article/291931</a> ，但并不都适合我们，对于我们的项目而言可以才有如下方案</p><h4 id="2-1-通过代理解决跨域"><a href="#2-1-通过代理解决跨域" class="headerlink" title="2.1.通过代理解决跨域"></a>2.1.通过代理解决跨域</h4><p>通过代理方式解决跨域这里介绍2种方案，一是通过Nginx反向代理解决，二是通过Vue的 <code>ProxyTable</code> 配置代理，对于Nginx方案后面会学到，这里重点说说 proxyTable方案。</p><p>跨域问题是因为JS出现跨域名访问，proxyTable这种方案的大概翻译是让JS发往后端的请求发送给VUE自己，VUE通过proxyTable把请求转发给后端，这样一来就不存在跨域了。</p><p><img src="/breeze/58abc14f/1619171893973.png" alt="1619171893973"></p><p>假定前端域名为：localhost:6001 , 后台域名为：localhost:80 , 修改 index.js ，增加如下内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">proxyTable</span>: &#123;</span><br><span class="line">    <span class="string">&#x27;/api&#x27;</span>: &#123;	<span class="comment">//所有以api开头的url都代理给下面的地址</span></span><br><span class="line">        <span class="attr">target</span>: <span class="string">&#x27;http://localhost:80&#x27;</span>,	<span class="comment">//所有以api开头的请求，都代理给 http://localhost:80</span></span><br><span class="line">            <span class="attr">changeOrigin</span>: <span class="literal">true</span>,</span><br><span class="line">                <span class="attr">pathRewrite</span>: &#123;	<span class="comment">//路径重新</span></span><br><span class="line">                    <span class="string">&#x27;^/api&#x27;</span>: <span class="string">&#x27;&#x27;</span> <span class="comment">// 当请求的地址中有api开头，会去掉api吧请求定向到  http://localhost:80 后台地址</span></span><br><span class="line">                &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>在main.js添加统一的 api前缀</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">axios.<span class="property">defaults</span>.<span class="property">baseURL</span>=<span class="string">&#x27;/api&#x27;</span></span><br></pre></td></tr></table></figure><p>页面请求效果</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">post</span>(<span class="string">&quot;/dept/page&quot;</span>,para)...省略...</span><br></pre></td></tr></table></figure><p>这里发送的请求其实是 ： <code>http://localhost:6001/api/dept/page</code> ，该请求被proxyTable代理给 <a target="_blank" rel="noopener" href="http://localhost/api/dept/page">http://localhost:80/api/dept/page</a> 并去掉前缀api变成： <a target="_blank" rel="noopener" href="http://localhost/dept/page">http://localhost:80/dept/page</a> ，即正确的后台地址。</p><p><code>【注意】改了代理配置要重启</code></p><h4 id="2-2-后端CrosFilter解决【后面讲】"><a href="#2-2-后端CrosFilter解决【后面讲】" class="headerlink" title="2.2.后端CrosFilter解决【后面讲】"></a>2.2.后端CrosFilter解决【后面讲】</h4><p>你可以看到当我们在向后台发请求的时候会多出来一个options请求，这个请求其实是在询问后台是否允许当前请求跨域</p><p>所以第二种就是在后端使用<code>CrosFilter</code>过滤器来解决跨域 ， 原理如下：</p><p><img src="/breeze/58abc14f/1619166838139.png" alt="1619166838139"></p><p>后端配置跨域：</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.crud.config;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Bean;</span><br><span class="line"><span class="keyword">import</span> org.springframework.context.annotation.Configuration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.cors.CorsConfiguration;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.cors.UrlBasedCorsConfigurationSource;</span><br><span class="line"><span class="keyword">import</span> org.springframework.web.filter.CorsFilter;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Configuration</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">GlobalCorsConfig</span> &#123;</span><br><span class="line">    <span class="meta">@Bean</span></span><br><span class="line">    <span class="keyword">public</span> CorsFilter <span class="title function_">corsFilter</span><span class="params">()</span> &#123;</span><br><span class="line">        <span class="comment">//1.添加CORS配置信息</span></span><br><span class="line">        <span class="type">CorsConfiguration</span> <span class="variable">config</span> <span class="operator">=</span> <span class="keyword">new</span> <span class="title class_">CorsConfiguration</span>();</span><br><span class="line">        <span class="comment">//1) 允许的域,不要写*，否则cookie就无法使用了</span></span><br><span class="line">        config.addAllowedOrigin(<span class="string">&quot;http://127.0.0.1:8081&quot;</span>);</span><br><span class="line">        config.addAllowedOrigin(<span class="string">&quot;http://localhost:8081&quot;</span>);</span><br><span class="line">        config.addAllowedOrigin(<span class="string">&quot;http://127.0.0.1:80&quot;</span>);</span><br><span class="line">        config.addAllowedOrigin(<span class="string">&quot;http://localhost:80&quot;</span>);</span><br><span class="line">        config.addAllowedOrigin(<span class="string">&quot;http://127.0.0.1&quot;</span>);</span><br><span class="line">        config.addAllowedOrigin(<span class="string">&quot;http://localhost&quot;</span>);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">        <span class="comment">//2) 是否发送Cookie信息</span></span><br><span class="line">        config.setAllowCredentials(<span class="literal">true</span>);</span><br><span class="line">        <span class="comment">//3) 允许的请求方式</span></span><br><span class="line">        config.addAllowedMethod(<span class="string">&quot;OPTIONS&quot;</span>);</span><br><span class="line">        config.addAllowedMethod(<span class="string">&quot;HEAD&quot;</span>);</span><br><span class="line">        config.addAllowedMethod(<span class="string">&quot;GET&quot;</span>);</span><br><span class="line">        config.addAllowedMethod(<span class="string">&quot;PUT&quot;</span>);</span><br><span class="line">        config.addAllowedMethod(<span class="string">&quot;POST&quot;</span>);</span><br><span class="line">        config.addAllowedMethod(<span class="string">&quot;DELETE&quot;</span>);</span><br><span class="line">        config.addAllowedMethod(<span class="string">&quot;PATCH&quot;</span>);</span><br><span class="line">        <span class="comment">// 4）允许的头信息</span></span><br><span class="line">        config.addAllowedHeader(<span class="string">&quot;*&quot;</span>);</span><br><span class="line">        <span class="comment">//2.添加映射路径，我们拦截一切请求</span></span><br><span class="line">        <span class="type">UrlBasedCorsConfigurationSource</span> <span class="variable">configSource</span> <span class="operator">=</span> <span class="keyword">new</span></span><br><span class="line">            <span class="title class_">UrlBasedCorsConfigurationSource</span>();</span><br><span class="line">        configSource.registerCorsConfiguration(<span class="string">&quot;/**&quot;</span>, config);</span><br><span class="line">        <span class="comment">//3.返回新的CorsFilter.</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">CorsFilter</span>(configSource);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="五-高级查询和分页"><a href="#五-高级查询和分页" class="headerlink" title="五.高级查询和分页"></a>五.高级查询和分页</h2><h3 id="1-前端页面"><a href="#1-前端页面" class="headerlink" title="1.前端页面"></a>1.前端页面</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--工具条--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-col</span> <span class="attr">:span</span>=<span class="string">&quot;24&quot;</span> <span class="attr">class</span>=<span class="string">&quot;toolbar&quot;</span> <span class="attr">style</span>=<span class="string">&quot;padding-bottom: 0px;&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:inline</span>=<span class="string">&quot;true&quot;</span> <span class="attr">:model</span>=<span class="string">&quot;query&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;query.keyword&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;关键字&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> <span class="attr">v-on:click</span>=<span class="string">&quot;search&quot;</span>&gt;</span>查询<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleAdd&quot;</span>&gt;</span>新增<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-col</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-查询携带条件数据"><a href="#2-查询携带条件数据" class="headerlink" title="2.查询携带条件数据"></a>2.查询携带条件数据</h3><p>前端</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">search</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">query</span>.<span class="property">currentPage</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getDepartment</span>();</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><p>后端：抽取公共的Query</p><p>BaseQuery</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.query;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">BaseQuery</span> &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 当前页</span></span><br><span class="line">    <span class="keyword">private</span> <span class="type">Integer</span> <span class="variable">currentPage</span> <span class="operator">=</span> <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 每页显示条数</span></span><br><span class="line">    <span class="keyword">private</span> Integer pageSize= <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 关键字</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">private</span> String keyword;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * 获取起始条数</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@return</span></span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="keyword">public</span> Integer <span class="title function_">getStart</span><span class="params">()</span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">this</span>.currentPage-<span class="number">1</span>)*<span class="built_in">this</span>.pageSize;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>DepartmentQuery</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> cn.mliutm.query;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> lombok.Data;</span><br><span class="line"></span><br><span class="line"><span class="meta">@Data</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title class_">DepartmentQuery</span> <span class="keyword">extends</span> <span class="title class_">BaseQuery</span>&#123;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h3 id="3-列表格式化"><a href="#3-列表格式化" class="headerlink" title="3.列表格式化"></a>3.列表格式化</h3><p><img src="/breeze/58abc14f/1641465095306.png" alt="1641465095306"></p><p>格式化状态栏的显示数据</p><p>​	方式一(推荐)：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;state&quot;</span> <span class="attr">label</span>=<span class="string">&quot;状态&quot;</span> <span class="attr">width</span>=<span class="string">&quot;120&quot;</span> <span class="attr">sortable</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&quot;scope.row.state==&#x27;-1&#x27;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color: red&quot;</span>&gt;</span>停用<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">span</span> <span class="attr">v-if</span>=<span class="string">&quot;scope.row.state==&#x27;0&#x27;&quot;</span> <span class="attr">style</span>=<span class="string">&quot;color: green&quot;</span>&gt;</span>正常<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br></pre></td></tr></table></figure><p>方式二：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;state&quot;</span> <span class="attr">label</span>=<span class="string">&quot;状态&quot;</span> <span class="attr">width</span>=<span class="string">&quot;120&quot;</span>   <span class="attr">:formatter</span>=<span class="string">&quot;formatState&quot;</span> <span class="attr">sortable</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br></pre></td></tr></table></figure><p>js添加方法：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">methods</span>: &#123;</span><br><span class="line">    <span class="comment">//状态的显示转换</span></span><br><span class="line">    <span class="attr">formatState</span>: <span class="keyword">function</span> (<span class="params">row, column</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> row.<span class="property">state</span> == <span class="number">0</span> ? <span class="string">&#x27;正常&#x27;</span> : <span class="string">&#x27;停用 &#x27;</span>;</span><br><span class="line">    &#125;,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>展示上级部门：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">prop</span>=<span class="string">&quot;parent.name&quot;</span> <span class="attr">label</span>=<span class="string">&quot;上级部门&quot;</span> &gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="六-删除"><a href="#六-删除" class="headerlink" title="六.删除"></a>六.删除</h2><h3 id="1-给按钮添加事件"><a href="#1-给按钮添加事件" class="headerlink" title="1.给按钮添加事件"></a>1.给按钮添加事件</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">el-table-column</span> <span class="attr">label</span>=<span class="string">&quot;操作&quot;</span> <span class="attr">width</span>=<span class="string">&quot;150&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">template</span> <span class="attr">scope</span>=<span class="string">&quot;scope&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleEdit(scope.$index, scope.row)&quot;</span>&gt;</span>编辑<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;danger&quot;</span> <span class="attr">size</span>=<span class="string">&quot;small&quot;</span> @<span class="attr">click</span>=<span class="string">&quot;handleDel(scope.$index, scope.row)&quot;</span>&gt;</span>删除<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">template</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-table-column</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-js"><a href="#2-js" class="headerlink" title="2.js"></a>2.js</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//删除的方法  index:当前数据的行号    row:当前行数据</span></span><br><span class="line"><span class="title function_">handleDel</span>(<span class="params">index,row</span>)&#123;</span><br><span class="line">    <span class="comment">//1.删除的确认框</span></span><br><span class="line">    <span class="variable language_">this</span>.$confirm(<span class="string">&#x27;确认删除该记录吗?&#x27;</span>, <span class="string">&#x27;提示&#x27;</span>, &#123;</span><br><span class="line">        <span class="attr">type</span>: <span class="string">&#x27;warning&#x27;</span></span><br><span class="line">    &#125;).<span class="title function_">then</span>(<span class="function">()=&gt;</span>&#123;<span class="comment">//确认删除的按钮</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">listLoading</span> = <span class="literal">true</span>;</span><br><span class="line">        <span class="comment">//获取删除数据id</span></span><br><span class="line">        <span class="keyword">let</span> id= row.<span class="property">id</span>;</span><br><span class="line">        <span class="comment">//发送请求 &quot;/dept/3&quot;</span></span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">delete</span>(<span class="string">&quot;/department/&quot;</span>+id).<span class="title function_">then</span>(<span class="function"><span class="params">res</span>=&gt;</span>&#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">listLoading</span> = <span class="literal">false</span>;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">debug</span>(res)</span><br><span class="line">            <span class="keyword">let</span> &#123;success,message&#125;=res.<span class="property">data</span>;</span><br><span class="line">            <span class="keyword">if</span> (success)&#123;</span><br><span class="line">                <span class="variable language_">this</span>.$message(&#123;</span><br><span class="line">                    <span class="attr">message</span>: <span class="string">&#x27;删除成功&#x27;</span>,</span><br><span class="line">                    <span class="attr">type</span>: <span class="string">&#x27;success&#x27;</span></span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">$message</span>.<span class="title function_">error</span>(<span class="string">&#x27;网络异常&#x27;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="comment">//重新加载数据</span></span><br><span class="line">            <span class="variable language_">this</span>.<span class="title function_">loadListData</span>();</span><br><span class="line">        &#125;)</span><br><span class="line"></span><br><span class="line">    &#125;).<span class="title function_">catch</span>(<span class="function">()=&gt;</span>&#123;<span class="comment">//取消删除回调函数</span></span><br><span class="line">        <span class="variable language_">this</span>.$message(<span class="string">&#x27;已取消删除&#x27;</span>);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h2 id="七-部门添加和修改-关联数据"><a href="#七-部门添加和修改-关联数据" class="headerlink" title="七 .部门添加和修改-关联数据"></a>七 .部门添加和修改-关联数据</h2><h3 id="1-界面准备"><a href="#1-界面准备" class="headerlink" title="1.界面准备"></a>1.界面准备</h3><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!--新增/编辑界面--&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- :visible.sync  控制dialog是否显示</span></span><br><span class="line"><span class="comment">:rules  绑定表单校验规则</span></span><br><span class="line"><span class="comment">ref=&quot;saveForm&quot;  给当前表单取一个别名</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">prop:绑定校验规则的名称</span></span><br><span class="line"><span class="comment"></span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">el-dialog</span> <span class="attr">:title</span>=<span class="string">&quot;title&quot;</span> <span class="attr">:visible.sync</span>=<span class="string">&quot;saveFormVisible&quot;</span> <span class="attr">:close-on-click-modal</span>=<span class="string">&quot;false&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">el-form</span> <span class="attr">:model</span>=<span class="string">&quot;saveForm&quot;</span> <span class="attr">label-width</span>=<span class="string">&quot;80px&quot;</span> <span class="attr">:rules</span>=<span class="string">&quot;saveFormRules&quot;</span> <span class="attr">ref</span>=<span class="string">&quot;saveForm&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;名称&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;name&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;saveForm.name&quot;</span> <span class="attr">auto-complete</span>=<span class="string">&quot;off&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;编号&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;sn&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-input</span> <span class="attr">v-model</span>=<span class="string">&quot;saveForm.sn&quot;</span> <span class="attr">auto-complete</span>=<span class="string">&quot;off&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">el-input</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;状态&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-radio-group</span> <span class="attr">v-model</span>=<span class="string">&quot;saveForm.state&quot;</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">class</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">:label</span>=<span class="string">&quot;0&quot;</span>&gt;</span>启用<span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-radio</span> <span class="attr">class</span>=<span class="string">&quot;radio&quot;</span> <span class="attr">:label</span>=<span class="string">&quot;-1&quot;</span>&gt;</span>禁用<span class="tag">&lt;/<span class="name">el-radio</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-radio-group</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;管理员&quot;</span> <span class="attr">prop</span>=<span class="string">&quot;manager&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-select</span> <span class="attr">v-model</span>=<span class="string">&quot;saveForm.manager&quot;</span> <span class="attr">clearable</span> <span class="attr">value-key</span>=<span class="string">&quot;id&quot;</span> <span class="attr">placeholder</span>=<span class="string">&quot;请选择&quot;</span>&gt;</span></span><br><span class="line">                <span class="comment">&lt;!--下拉选项</span></span><br><span class="line"><span class="comment">:key=&quot;&quot;  //唯一标识</span></span><br><span class="line"><span class="comment">:label 选择之后展示到选择框中的值</span></span><br><span class="line"><span class="comment">:value 选中之后绑定给模型层的值  如果要绑定对象给模型层 有一个大坑</span></span><br><span class="line"><span class="comment">必须要写  value-key=&quot;id&quot;</span></span><br><span class="line"><span class="comment">--&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">el-option</span></span></span><br><span class="line"><span class="tag">                           <span class="attr">v-for</span>=<span class="string">&quot;item in employees&quot;</span></span></span><br><span class="line"><span class="tag">                           <span class="attr">:key</span>=<span class="string">&quot;item.id&quot;</span></span></span><br><span class="line"><span class="tag">                           <span class="attr">:label</span>=<span class="string">&quot;item.username&quot;</span></span></span><br><span class="line"><span class="tag">                           <span class="attr">:value</span>=<span class="string">&quot;item&quot;</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;float: left&quot;</span>&gt;</span>&#123;&#123; item.username &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">span</span> <span class="attr">style</span>=<span class="string">&quot;float: right; color: #8492a6; font-size: 13px&quot;</span>&gt;</span>&#123;&#123; item.phone &#125;&#125;<span class="tag">&lt;/<span class="name">span</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">el-option</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">el-select</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-form-item</span> <span class="attr">label</span>=<span class="string">&quot;上级部门&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">el-cascader</span> <span class="attr">v-model</span>=<span class="string">&quot;saveForm.parent&quot;</span></span></span><br><span class="line"><span class="tag">                         <span class="attr">:options</span>=<span class="string">&quot;deptTree&quot;</span></span></span><br><span class="line"><span class="tag">                         <span class="attr">:props</span>=<span class="string">&quot;&#123;</span></span></span><br><span class="line"><span class="string"><span class="tag">                                 checkStrictly: true,</span></span></span><br><span class="line"><span class="string"><span class="tag">                                 label:&#x27;name&#x27;,</span></span></span><br><span class="line"><span class="string"><span class="tag">                                 value:&#x27;id&#x27;</span></span></span><br><span class="line"><span class="string"><span class="tag">                                 &#125;&quot;</span></span></span><br><span class="line"><span class="tag">                         <span class="attr">clearable</span>&gt;</span><span class="tag">&lt;/<span class="name">el-cascader</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">el-form-item</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">el-form</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">slot</span>=<span class="string">&quot;footer&quot;</span> <span class="attr">class</span>=<span class="string">&quot;dialog-footer&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> @<span class="attr">click.native</span>=<span class="string">&quot;saveFormVisible = false&quot;</span>&gt;</span>取消<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">el-button</span> <span class="attr">type</span>=<span class="string">&quot;primary&quot;</span> @<span class="attr">click.native</span>=<span class="string">&quot;saveSubmit&quot;</span> <span class="attr">:loading</span>=<span class="string">&quot;saveLoading&quot;</span>&gt;</span>提交<span class="tag">&lt;/<span class="name">el-button</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">el-dialog</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="2-js代码"><a href="#2-js代码" class="headerlink" title="2.js代码"></a>2.js代码</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">saveFormVisible</span>: <span class="literal">false</span>,<span class="comment">//新增界面是否显示</span></span><br><span class="line">    <span class="attr">saveLoading</span>: <span class="literal">false</span>,</span><br><span class="line">        <span class="attr">saveFormRules</span>: &#123;</span><br><span class="line">            <span class="attr">name</span>: [</span><br><span class="line">                &#123; <span class="attr">required</span>: <span class="literal">true</span>, <span class="attr">message</span>: <span class="string">&#x27;请输入名字&#x27;</span>, <span class="attr">trigger</span>: <span class="string">&#x27;blur&#x27;</span> &#125;</span><br><span class="line">            ]</span><br><span class="line">        &#125;,</span><br><span class="line">            <span class="comment">//新增界面数据</span></span><br><span class="line">            <span class="attr">saveForm</span>: &#123;</span><br><span class="line">                <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">                    <span class="attr">intro</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">                        <span class="attr">manager</span>:&#123;</span><br><span class="line">                            <span class="attr">id</span>:<span class="literal">null</span>,</span><br><span class="line">                                <span class="attr">username</span>:<span class="string">&quot;&quot;</span></span><br><span class="line">                        &#125;,</span><br><span class="line">                            <span class="attr">parent</span>:&#123;</span><br><span class="line">                                <span class="attr">id</span>:<span class="literal">null</span>,</span><br><span class="line">                                    <span class="attr">name</span>:<span class="string">&quot;&quot;</span></span><br><span class="line">                            &#125;,</span><br><span class="line">                                <span class="attr">state</span>:<span class="literal">null</span></span><br><span class="line">            &#125;,</span><br><span class="line">                <span class="attr">employees</span>:[],</span><br><span class="line">                    <span class="attr">deptTree</span>:[]</span><br><span class="line"></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//显示新增界面</span></span><br><span class="line"><span class="attr">handleAdd</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">saveFormVisible</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">saveForm</span> = &#123;</span><br><span class="line">        <span class="attr">name</span>: <span class="string">&#x27;&#x27;</span>,</span><br><span class="line">        <span class="attr">intro</span>:<span class="string">&quot;&quot;</span>,</span><br><span class="line">        <span class="attr">manager</span>:&#123;</span><br><span class="line">            <span class="attr">id</span>:<span class="literal">null</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">parent</span>:&#123;</span><br><span class="line">            <span class="attr">id</span>:<span class="literal">null</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">state</span>:<span class="literal">null</span></span><br><span class="line">    &#125;;</span><br><span class="line">    <span class="comment">// 查询部门树</span></span><br><span class="line">    <span class="title function_">getDeptTree</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">get</span>(<span class="string">&quot;/department/tree&quot;</span>)</span><br><span class="line">            .<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">            result = result.<span class="property">data</span>;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">deptTree</span> = result.<span class="property">data</span>;</span><br><span class="line">        &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">            <span class="variable language_">this</span>.$message(&#123; <span class="attr">message</span>: <span class="string">&#x27;查询部门树失败&#x27;</span>,<span class="attr">type</span>: <span class="string">&#x27;error&#x27;</span>&#125;);</span><br><span class="line">        &#125;)</span><br><span class="line">    &#125;,</span><br><span class="line">        <span class="comment">// 查询所有员工</span></span><br><span class="line">        <span class="title function_">getAllEmployee</span>(<span class="params"></span>)&#123;</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">get</span>(<span class="string">&quot;/employee&quot;</span>)</span><br><span class="line">                .<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">console</span>.<span class="title function_">log</span>(result);</span><br><span class="line">                result = result.<span class="property">data</span>;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">employees</span> = result.<span class="property">data</span>;</span><br><span class="line">            &#125;).<span class="title function_">catch</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.$message(&#123; <span class="attr">message</span>: <span class="string">&#x27;查询员工失败&#x27;</span>,<span class="attr">type</span>: <span class="string">&#x27;error&#x27;</span>&#125;);</span><br><span class="line">            &#125;)</span><br><span class="line">        &#125;,</span><br></pre></td></tr></table></figure><h3 id="3-关联数据动态加载-后台"><a href="#3-关联数据动态加载-后台" class="headerlink" title="3.关联数据动态加载-后台"></a>3.关联数据动态加载-后台</h3><p>查询部门树</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@GetMapping(&quot;/tree&quot;)</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">getDeptTree</span><span class="params">()</span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        List&lt;Department&gt; deptTree = departmentService.getDeptTree();</span><br><span class="line">        <span class="keyword">return</span> AjaxResult.me().setData(deptTree);</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> AjaxResult.me().setSuccess(<span class="literal">false</span>).setMessage(<span class="string">&quot;查询部门树失败!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">select</span> <span class="attr">id</span>=<span class="string">&quot;loadDeptTree&quot;</span> <span class="attr">resultMap</span>=<span class="string">&quot;BaseResultMap&quot;</span>&gt;</span></span><br><span class="line">    SELECT</span><br><span class="line">    p.*,</span><br><span class="line">    c.id AS cid,</span><br><span class="line">    c.NAME AS cname</span><br><span class="line">    FROM</span><br><span class="line">    t_department p</span><br><span class="line">    LEFT JOIN t_department c ON p.id = c.parent_id</span><br><span class="line">    where p.parent_id is null</span><br><span class="line"><span class="tag">&lt;/<span class="name">select</span>&gt;</span></span><br></pre></td></tr></table></figure><h3 id="4-保存数据"><a href="#4-保存数据" class="headerlink" title="4.保存数据"></a>4.保存数据</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//保存数据</span></span><br><span class="line"><span class="attr">saveSubmit</span>: <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">$refs</span>.<span class="property">saveForm</span>.<span class="title function_">validate</span>(<span class="function">(<span class="params">valid</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (valid) &#123;</span><br><span class="line">            <span class="variable language_">this</span>.$confirm(<span class="string">&#x27;确认提交吗？&#x27;</span>, <span class="string">&#x27;提示&#x27;</span>, &#123;&#125;).<span class="title function_">then</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">saveLoading</span> = <span class="literal">true</span>;</span><br><span class="line">                <span class="comment">//NProgress.start();</span></span><br><span class="line">                <span class="keyword">let</span> para = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, <span class="variable language_">this</span>.<span class="property">saveForm</span>);</span><br><span class="line">                <span class="comment">// 处理父部门</span></span><br><span class="line">                <span class="keyword">if</span>(para.<span class="property">parent</span>)&#123;<span class="comment">// [2,7]</span></span><br><span class="line">                    para.<span class="property">parent</span> = &#123;<span class="string">&quot;id&quot;</span>:para.<span class="property">parent</span>[para.<span class="property">parent</span>.<span class="property">length</span>-<span class="number">1</span>]&#125;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="variable language_">this</span>.<span class="property">$http</span>.<span class="title function_">put</span>(<span class="string">&quot;/department&quot;</span>,para)</span><br><span class="line">                    .<span class="title function_">then</span>(<span class="function"><span class="params">result</span> =&gt;</span> &#123;</span><br><span class="line">                    result = result.<span class="property">data</span>;</span><br><span class="line">                    <span class="keyword">if</span>(result.<span class="property">success</span>)&#123;</span><br><span class="line">                        <span class="variable language_">this</span>.<span class="property">query</span>.<span class="property">currentPage</span> = <span class="number">1</span>;</span><br><span class="line">                        <span class="variable language_">this</span>.<span class="title function_">getDepartment</span>();</span><br><span class="line">                        <span class="variable language_">this</span>.<span class="property">saveLoading</span> = <span class="literal">false</span>;</span><br><span class="line">                        <span class="variable language_">this</span>.<span class="property">saveFormVisible</span> = <span class="literal">false</span>;</span><br><span class="line">                        <span class="variable language_">this</span>.$message(&#123; <span class="attr">message</span>: <span class="string">&#x27;保存成功&#x27;</span>,<span class="attr">type</span>: <span class="string">&#x27;success&#x27;</span>&#125;);</span><br><span class="line">                    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">                        <span class="variable language_">this</span>.$message(&#123; <span class="attr">message</span>: result.<span class="property">message</span>,<span class="attr">type</span>: <span class="string">&#x27;error&#x27;</span>&#125;);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h3 id="5-保存后台"><a href="#5-保存后台" class="headerlink" title="5.保存后台"></a>5.保存后台</h3><p>​	Controller</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@PutMapping</span></span><br><span class="line"><span class="keyword">public</span> AjaxResult <span class="title function_">addOrUpdate</span><span class="params">(<span class="meta">@RequestBody</span> Department department)</span>&#123;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(Objects.isNull(department.getId()))&#123;</span><br><span class="line">            departmentService.add(department);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            departmentService.update(department);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (Exception e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">        <span class="keyword">return</span> AjaxResult.me().setSuccess(<span class="literal">false</span>).setMessage(<span class="string">&quot;保存失败!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> AjaxResult.me();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>​	服务层代码</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">add</span><span class="params">(Department department)</span> &#123;</span><br><span class="line">    <span class="comment">// 处理新增时间</span></span><br><span class="line">    department.setCreate_time(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    departmentMapper.insert(department);</span><br><span class="line">    <span class="comment">// 处理path</span></span><br><span class="line">    <span class="comment">// 判断父部门是否存在</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="type">Department</span> <span class="variable">parent</span> <span class="operator">=</span> department.getParent();</span><br><span class="line">    <span class="keyword">if</span>(Objects.nonNull(parent.getId()))&#123;</span><br><span class="line">        <span class="comment">// 根据父部门的id，查询父部门的信息</span></span><br><span class="line">        parent = departmentMapper.loadById(parent.getId());</span><br><span class="line">        <span class="comment">// 父部门存在，该新增部门path = 父部门的path+&quot;/&quot;+自己的id</span></span><br><span class="line">        path = parent.getPath()+<span class="string">&quot;/&quot;</span>+department.getId();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// 父部门不存在，那么该新增部门的path=/自己的id</span></span><br><span class="line">        path = <span class="string">&quot;/&quot;</span>+department.getId();</span><br><span class="line">    &#125;</span><br><span class="line">    department.setPath(path);</span><br><span class="line">    departmentMapper.update(department);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="八-修改"><a href="#八-修改" class="headerlink" title="八.修改"></a>八.修改</h2><h3 id="1-前端-打开编辑模态框"><a href="#1-前端-打开编辑模态框" class="headerlink" title="1.前端-打开编辑模态框"></a>1.前端-打开编辑模态框</h3><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//显示编辑界面</span></span><br><span class="line"><span class="attr">handleEdit</span>: <span class="keyword">function</span> (<span class="params">index, row</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">saveFormVisible</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">saveForm</span> = <span class="title class_">Object</span>.<span class="title function_">assign</span>(&#123;&#125;, row);</span><br><span class="line">    <span class="comment">// 父部门回显</span></span><br><span class="line">    <span class="keyword">let</span> temp = [];</span><br><span class="line">    <span class="keyword">if</span>(row.<span class="property">path</span>)&#123;</span><br><span class="line">        <span class="keyword">let</span> array = row.<span class="property">path</span>.<span class="title function_">split</span>(<span class="string">&quot;/&quot;</span>);</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">1</span>;i&lt;array.<span class="property">length</span>-<span class="number">1</span>;i++)&#123;</span><br><span class="line">            temp.<span class="title function_">push</span>(<span class="built_in">parseInt</span>(array[i]));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">saveForm</span>.<span class="property">parent</span> = temp;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="variable language_">this</span>.<span class="property">saveForm</span>);</span><br><span class="line">    <span class="comment">// 查询所有的员工</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getAllEmployee</span>();</span><br><span class="line">    <span class="comment">// 查询部门树</span></span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">getDeptTree</span>();</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure><h3 id="2-后台代码"><a href="#2-后台代码" class="headerlink" title="2.后台代码"></a>2.后台代码</h3><p>DepartmentServiceImpl</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@Transactional</span></span><br><span class="line"><span class="meta">@Override</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title function_">update</span><span class="params">(Department department)</span> &#123;</span><br><span class="line">    <span class="comment">// 处理修改时间</span></span><br><span class="line">    department.setUpdate_time(<span class="keyword">new</span> <span class="title class_">Date</span>());</span><br><span class="line">    <span class="comment">// 处理path</span></span><br><span class="line">    <span class="comment">// 判断父部门是否存在</span></span><br><span class="line">    <span class="type">String</span> <span class="variable">path</span> <span class="operator">=</span> <span class="string">&quot;&quot;</span>;</span><br><span class="line">    <span class="keyword">if</span>(Objects.nonNull(department.getParent()))&#123;</span><br><span class="line">        <span class="comment">// 根据父部门的id，查询父部门的信息</span></span><br><span class="line">        <span class="type">Department</span> <span class="variable">parent</span> <span class="operator">=</span> departmentMapper.loadById(department.getParent().getId());</span><br><span class="line">        <span class="comment">// 父部门存在，该部门path = 父部门的path+&quot;/&quot;+自己的id</span></span><br><span class="line">        path = parent.getPath()+<span class="string">&quot;/&quot;</span>+department.getId();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// 父部门不存在，那么该部门的path=/自己的id</span></span><br><span class="line">        path = <span class="string">&quot;/&quot;</span>+department.getId();</span><br><span class="line">    &#125;</span><br><span class="line">    department.setPath(path);</span><br><span class="line">    departmentMapper.update(department);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="https://mliutm.github.io">清风</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://mliutm.github.io/breeze/58abc14f.html">https://mliutm.github.io/breeze/58abc14f.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://mliutm.github.io" target="_blank">清风</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/java/">java</a></div><div class="post_share"><div class="social-share" data-image="/img/photo-1645943020355-305df166473d.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/sharejs/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/wechat.jpg" target="_blank"><img class="post-qr-code-img" src="/img/wechat.jpg" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/breeze/4c9bef51.html" title="base抽取与代码生成器（三）"><img class="cover" src="/img/premium_photo-1695185954894-e9382c6f4da8.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">base抽取与代码生成器（三）</div></div></a></div><div class="next-post pull-right"><a href="/breeze/19c338a6.html" title="权限管理的认识与后端项目搭建（一）"><img class="cover" src="/img/photo-1688475747590-d0db5e2412cb.jpg" onerror='onerror=null,src="/img/404.jpg"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">权限管理的认识与后端项目搭建（一）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/breeze/c8b66f0a.html" title="File类"><img class="cover" src="/img/photo-1692708632140-ee01624d558d.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-15</div><div class="title">File类</div></div></a></div><div><a href="/breeze/ecebeadb.html" title="BIO-NIO-AIO深入剖析"><img class="cover" src="/img/photo-1692708632140-ee01624d558d.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-15</div><div class="title">BIO-NIO-AIO深入剖析</div></div></a></div><div><a href="/breeze/fed4c017.html" title="IO流"><img class="cover" src="/img/photo-1692708632140-ee01624d558d.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-15</div><div class="title">IO流</div></div></a></div><div><a href="/breeze/a4950fb1.html" title="Redis实战-黑马点评"><img class="cover" src="/img/photo-1688475747590-d0db5e2412cb.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-24</div><div class="title">Redis实战-黑马点评</div></div></a></div><div><a href="/breeze/ab319c68.html" title="SpringCloud-Alibaba快速入门"><img class="cover" src="/img/photo-1645943020355-305df166473d.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-01-13</div><div class="title">SpringCloud-Alibaba快速入门</div></div></a></div><div><a href="/breeze/4c9bef51.html" title="base抽取与代码生成器（三）"><img class="cover" src="/img/premium_photo-1695185954894-e9382c6f4da8.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-10-28</div><div class="title">base抽取与代码生成器（三）</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src="/img/avatar.jpg" onerror='this.onerror=null,this.src="/img/friend_404.gif"' alt="avatar"></div><div class="author-info__name">清风</div><div class="author-info__description">清风洒六合，邈然不可攀</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">169</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">82</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">31</div></a></div><a id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/xxxxxx"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="mailto:huangpan0805@163.com" target="_blank" title="Email"><i class="fas fa-envelope-open-text"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn fa-shake"></i><span>公告</span></div><div class="announcement_content">This is my Blog</div><timing></timing></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content is-expand"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E6%9D%83%E9%99%90%E5%9F%BA%E7%A1%80%E5%B9%B3%E5%8F%B0%E7%B3%BB%E7%BB%9F-%E9%83%A8%E9%97%A8%E7%AE%A1%E7%90%86"><span class="toc-text">权限基础平台系统-部门管理</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E5%AE%B9"><span class="toc-text">内容</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%80-%E5%89%8D%E7%AB%AF%E9%A1%B9%E7%9B%AE%E6%90%AD%E5%BB%BA"><span class="toc-text">一.前端项目搭建</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%9B%86%E6%88%90vue-admin"><span class="toc-text">1.集成vue-admin</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-IDEA%E5%AF%BC%E5%85%A5%E6%A8%A1%E6%9D%BF"><span class="toc-text">1.1.IDEA导入模板</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E5%AE%89%E8%A3%85%E6%8F%92%E4%BB%B6"><span class="toc-text">1.2.安装插件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-3-%E5%90%AF%E5%8A%A8%E9%A1%B9%E7%9B%AE"><span class="toc-text">1.3.启动项目</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-vue-admin%E8%B0%83%E6%95%B4"><span class="toc-text">2.vue-admin调整</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E6%B3%A8%E9%87%8Amock%E4%BB%A3%E7%A0%81"><span class="toc-text">2.1.注释mock代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E6%B3%A8%E9%87%8A%E7%99%BB%E5%BD%95%E6%8B%A6%E6%88%AA%E4%BB%A3%E7%A0%81"><span class="toc-text">2.2.注释登录拦截代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-%E5%BC%95%E5%85%A5axios%E4%BB%A3%E7%A0%81"><span class="toc-text">2.3.引入axios代码</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-%E6%B3%A8%E9%87%8A%E6%8E%89%E7%99%BB%E5%BD%95%E4%BB%A3%E7%A0%81"><span class="toc-text">2.4.注释掉登录代码</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E8%AE%A4%E8%AF%86vue-admin"><span class="toc-text">3.认识vue-admin</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-1-%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84"><span class="toc-text">3.1.目录结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-%E6%A0%87%E9%A2%98%E4%BF%AE%E6%94%B9"><span class="toc-text">3.2.标题修改</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-3-%E4%BF%AE%E6%94%B9logo"><span class="toc-text">3.3.修改logo</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-4-main-js%E8%AE%A4%E8%AF%86"><span class="toc-text">3.4.main.js认识</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-5-%E8%AE%A4%E8%AF%86routes-js"><span class="toc-text">3.5.认识routes.js</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%8C-%E5%90%8E%E7%AB%AF%E9%83%A8%E9%97%A8%E7%9A%84CRUD%E5%AE%9E%E7%8E%B0"><span class="toc-text">二.后端部门的CRUD实现</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%83%A8%E9%97%A8%E5%A2%9E%E5%88%A0%E6%94%B9%E5%AE%9E%E7%8E%B0"><span class="toc-text">1.部门增删改实现</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E9%83%A8%E9%97%A8%E5%88%86%E9%A1%B5%E5%AE%9E%E7%8E%B0"><span class="toc-text">2.部门分页实现</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E5%88%86%E9%A1%B5%E6%A6%82%E8%BF%B0"><span class="toc-text">1 分页概述</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#1-1-%E4%B8%BA%E4%BB%80%E4%B9%88%E9%9C%80%E8%A6%81%E5%88%86%E9%A1%B5"><span class="toc-text">1.1 为什么需要分页</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#1-2-%E5%88%86%E9%A1%B5%E7%9A%84%E5%88%86%E7%B1%BB"><span class="toc-text">1.2 分页的分类</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%88%86%E9%A1%B5%E5%AE%9E%E7%8E%B0"><span class="toc-text">2.分页实现</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#2-1-%E6%80%9D%E8%B7%AF%E5%88%86%E6%9E%90"><span class="toc-text">2.1 思路分析</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-2-%E5%B0%81%E8%A3%85Query%E5%92%8CPageList"><span class="toc-text">2.2 封装Query和PageList</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-3-service"><span class="toc-text">2.3 service</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-4-mapper"><span class="toc-text">2.4 mapper</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-5-junit%E6%B5%8B%E8%AF%95service"><span class="toc-text">2.5 junit测试service</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#2-6-controller"><span class="toc-text">2.6 controller</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%89-%E5%89%8D%E7%AB%AF%E9%83%A8%E9%97%A8%E5%88%86%E9%A1%B5%E5%88%97%E8%A1%A8"><span class="toc-text">三.前端部门分页列表</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E9%A1%B5%E9%9D%A2%E5%87%86%E5%A4%87"><span class="toc-text">1.页面准备</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9B%9B-%E8%B7%A8%E5%9F%9F%E9%97%AE%E9%A2%98"><span class="toc-text">四.跨域问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E8%B7%A8%E5%9F%9F%E7%90%86%E8%A7%A3"><span class="toc-text">1.跨域理解</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-1-%E4%BB%80%E4%B9%88%E6%98%AF%E8%B7%A8%E5%9F%9F"><span class="toc-text">1.1.什么是跨域</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#1-2-%E8%B7%A8%E5%9F%9F%E7%9A%84%E6%9D%A1%E4%BB%B6"><span class="toc-text">1.2.跨域的条件</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F"><span class="toc-text">2.解决跨域</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-%E9%80%9A%E8%BF%87%E4%BB%A3%E7%90%86%E8%A7%A3%E5%86%B3%E8%B7%A8%E5%9F%9F"><span class="toc-text">2.1.通过代理解决跨域</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-%E5%90%8E%E7%AB%AFCrosFilter%E8%A7%A3%E5%86%B3%E3%80%90%E5%90%8E%E9%9D%A2%E8%AE%B2%E3%80%91"><span class="toc-text">2.2.后端CrosFilter解决【后面讲】</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BA%94-%E9%AB%98%E7%BA%A7%E6%9F%A5%E8%AF%A2%E5%92%8C%E5%88%86%E9%A1%B5"><span class="toc-text">五.高级查询和分页</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2"><span class="toc-text">1.前端页面</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E6%9F%A5%E8%AF%A2%E6%90%BA%E5%B8%A6%E6%9D%A1%E4%BB%B6%E6%95%B0%E6%8D%AE"><span class="toc-text">2.查询携带条件数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%88%97%E8%A1%A8%E6%A0%BC%E5%BC%8F%E5%8C%96"><span class="toc-text">3.列表格式化</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AD-%E5%88%A0%E9%99%A4"><span class="toc-text">六.删除</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%BB%99%E6%8C%89%E9%92%AE%E6%B7%BB%E5%8A%A0%E4%BA%8B%E4%BB%B6"><span class="toc-text">1.给按钮添加事件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-js"><span class="toc-text">2.js</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%83-%E9%83%A8%E9%97%A8%E6%B7%BB%E5%8A%A0%E5%92%8C%E4%BF%AE%E6%94%B9-%E5%85%B3%E8%81%94%E6%95%B0%E6%8D%AE"><span class="toc-text">七 .部门添加和修改-关联数据</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E7%95%8C%E9%9D%A2%E5%87%86%E5%A4%87"><span class="toc-text">1.界面准备</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-js%E4%BB%A3%E7%A0%81"><span class="toc-text">2.js代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-%E5%85%B3%E8%81%94%E6%95%B0%E6%8D%AE%E5%8A%A8%E6%80%81%E5%8A%A0%E8%BD%BD-%E5%90%8E%E5%8F%B0"><span class="toc-text">3.关联数据动态加载-后台</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-%E4%BF%9D%E5%AD%98%E6%95%B0%E6%8D%AE"><span class="toc-text">4.保存数据</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-%E4%BF%9D%E5%AD%98%E5%90%8E%E5%8F%B0"><span class="toc-text">5.保存后台</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%AB-%E4%BF%AE%E6%94%B9"><span class="toc-text">八.修改</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-%E5%89%8D%E7%AB%AF-%E6%89%93%E5%BC%80%E7%BC%96%E8%BE%91%E6%A8%A1%E6%80%81%E6%A1%86"><span class="toc-text">1.前端-打开编辑模态框</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-%E5%90%8E%E5%8F%B0%E4%BB%A3%E7%A0%81"><span class="toc-text">2.后台代码</span></a></li></ol></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/breeze/1d13ce0d.html" title="WYDG-产品目录列表-20200506"><img src="/img/photo-1653549892896-dde02867edee.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="WYDG-产品目录列表-20200506"></a><div class="content"><a class="title" href="/breeze/1d13ce0d.html" title="WYDG-产品目录列表-20200506">WYDG-产品目录列表-20200506</a><time datetime="2025-04-13T05:43:05.000Z" title="发表于 2025-04-13 13:43:05">2025-04-13</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/breeze/6f268337.html" title="雨雀文件下载"><img src="/img/premium_photo-1695185954894-e9382c6f4da8.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="雨雀文件下载"></a><div class="content"><a class="title" href="/breeze/6f268337.html" title="雨雀文件下载">雨雀文件下载</a><time datetime="2024-05-22T12:25:08.000Z" title="发表于 2024-05-22 20:25:08">2024-05-22</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/breeze/7832219d.html" title="十万字面试总结"><img src="/img/photo-1692708632140-ee01624d558d.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="十万字面试总结"></a><div class="content"><a class="title" href="/breeze/7832219d.html" title="十万字面试总结">十万字面试总结</a><time datetime="2024-02-29T02:50:00.000Z" title="发表于 2024-02-29 10:50:00">2024-02-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/breeze/7ae0ca37.html" title="Redis_30道经典面试题"><img src="/img/photo-1653549892896-dde02867edee.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="Redis_30道经典面试题"></a><div class="content"><a class="title" href="/breeze/7ae0ca37.html" title="Redis_30道经典面试题">Redis_30道经典面试题</a><time datetime="2024-02-29T02:45:00.000Z" title="发表于 2024-02-29 10:45:00">2024-02-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/breeze/2a548e97.html" title="面试实战"><img src="/img/photo-1653549892896-dde02867edee.jpg" onerror='this.onerror=null,this.src="/img/404.jpg"' alt="面试实战"></a><div class="content"><a class="title" href="/breeze/2a548e97.html" title="面试实战">面试实战</a><time datetime="2024-02-29T02:43:59.000Z" title="发表于 2024-02-29 10:43:59">2024-02-29</time></div></div></div></div></div></div></main><footer id="footer" style="background-image:url(/img/photo-1645943020355-305df166473d.jpg)"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2025 <i id="heartbeat" class="fa fas fa-heartbeat"></i> 清风</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div><head><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/HCLonely/images@master/others/heartbeat.min.css"></head></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui/dist/fancybox/fancybox.umd.min.js"></script><div class="js-pjax"></div><script src="/js/timing.js"></script><script id="canvas_nest" defer color="255,0,255" opacity="0.7" zindex="-1" count="99" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/canvas-nest.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful=!0,POWERMODE.shake=!0,POWERMODE.mobile=!0,document.body.addEventListener("input",POWERMODE)</script><script id="click-show-text" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc/dist/click-show-text.min.js" data-mobile="true" data-text="天枢,天璇,天玑,天权,玉衡,开阳,瑶光" data-fontsize="15px" data-random="true" async></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span> 数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div class="no-result" id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js"></script></div></div></body></html>